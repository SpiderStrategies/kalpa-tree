<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link href="//fonts.googleapis.com/css?family=Source+Sans Pro:200italic,200,300italic,300,400italic,400,600italic,600,700italic,700,900italic,900" rel="stylesheet" type="text/css">
    <style>

      body {
        text-align: center;
        font-family: 'Source Sans Pro';
      }

      .container {
        position: absolute;
        width: 600px;
        height: 1000px;
        left: 250px;
        overflow: auto;
      }

      .coords {
        position: absolute;
        top: 10px;
        left: 10px;
      }

    </style>
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <g id="generic">
         <path d="M 10.739693,12.92454 C 8.091417,12.899551 5.4421685,12.975947 2.7946455,12.883732 1.5597127,12.66166 0.77083725,11.294016 0.99658183,10.098407 1.0152711,7.6404838 0.94616094,5.1815948 1.0355044,2.7244656 1.2574303,1.4894272 2.6248546,0.69958216 3.8207803,0.92543168 c 2.4576077,0.0187285 4.9161852,-0.0505225 7.3729957,0.0389979 1.234918,0.22251902 2.023465,1.59013902 1.798076,2.78582732 -0.02901,2.4833912 0.07192,4.9687854 -0.05697,7.4505511 -0.228835,0.979348 -1.182743,1.749302 -2.195189,1.723732 z M 8.9816934,6.2655397 C 9.0205264,5.4016165 8.083604,4.7190278 7.2656994,4.8988625 6.5201571,4.8330633 5.5562112,4.8462763 5.1430801,5.5922012 4.8835169,6.4282196 4.8778822,7.3504226 5.1219879,8.1881946 5.5023107,8.9207066 6.4383408,9.0109635 7.1714843,8.9305363 8.0119095,9.0869903 9.0297881,8.4684373 8.9788978,7.5430941 9.01247,7.1175973 8.9521044,6.6911303 8.9816934,6.2655397 z"/>
      </g>
      <g id="root">
        <path d="m 7.967755,12.919689 c 0,-1.671667 0,-3.3433333 0,-5.015 1.672,0 3.344,0 5.016,0 0,1.6716667 0,3.343333 0,5.015 -1.672,0 -3.344,0 -5.016,0 z m 0,-12.00399998 c 1.672,0 3.344,0 5.016,0 0,1.67166668 0,3.34333328 0,5.01499998 -1.672,0 -3.344,0 -5.016,0 0,-1.6716667 0,-3.3433333 0,-5.01499998 z M 0.97875502,7.904689 c 1.67199998,0 3.34399998,0 5.01599998,0 0,1.6716667 0,3.343333 0,5.015 -1.672,0 -3.344,0 -5.01599998,0 0,-1.671667 0,-3.3433333 0,-5.015 z m 0,-6.98899998 c 1.67199998,0 3.34399998,0 5.01599998,0 0,1.67166668 0,3.34333328 0,5.01499998 -1.672,0 -3.344,0 -5.01599998,0 0,-1.6716667 0,-3.3433333 0,-5.01499998 z"/>
      </g>
      <g id="perspective">
        <path d="m 12.984019,12.318708 c -4.0013334,0 -8.0026667,0 -12.00400011,0 C 2.9553522,8.6500413 4.9306856,4.9813746 6.9060189,1.3127079 c 2.026,3.6686667 4.0520001,7.3373334 6.0780001,11.0060001 z"/>
      </g>
      <g id="objective">
        <path d="m 6.995195,1.891158 c 2.386759,-0.046811 4.921778,1.2941224 5.77127,3.6100893 C 13.487453,7.5027677 12.436837,9.84606 10.625605,10.872058 7.9701574,12.570494 4.0634466,12.138208 2.0131387,9.682441 0.51631108,7.9846205 0.72528609,5.1185749 2.4364246,3.6408586 3.6379443,2.4712737 5.334508,1.8888035 6.995195,1.891158 z"/>
      </g>
      <g id="find">
        <path d="m 13.497323,12.433608 c 0.08422,0.978628 -1.417295,1.469942 -1.954282,0.657234 C 10.369384,11.968141 9.2411696,10.799391 8.087323,9.6566079 5.7875518,11.20515 2.2596241,10.270797 1.051352,7.7662065 -0.1027543,5.5922068 0.61269436,2.5743169 2.7539681,1.2885899 4.6322082,0.06461011 7.3623548,0.26924656 8.9286688,1.9183502 c 1.5121032,1.4872335 1.9726552,4.001359 0.8885116,5.8618536 -0.2008407,0.7179057 0.6439246,1.0286413 1.0395966,1.4627471 0.79551,0.9178591 1.752248,1.6943191 2.51171,2.6495761 0.08347,0.167322 0.129284,0.353872 0.128836,0.541081 z m -8.047,-9.7420001 C 3.5991559,2.6059751 2.107634,4.7815577 2.8684439,6.4772182 3.4629388,8.0470383 5.6500695,8.7859958 7.0177529,7.7488936 8.3664062,6.8424394 8.6521549,4.6587499 7.425963,3.52989 6.9118115,3.0069548 6.1883031,2.6803036 5.450323,2.6916079 z"/>
      </g>
      <g id="collapsed">
        <path d="M 9.9585564,6.8338173 C 9.9293142,7.4775125 9.3304268,7.8464666 8.9016778,8.2371365 7.7569911,9.2165326 6.6436108,10.235903 5.4779963,11.188722 4.8455224,11.544509 3.9641802,11.028114 3.9509963,10.304674 3.9096608,9.8426007 4.1932258,9.4144954 4.5730755,9.1755297 5.5222357,8.3779589 6.471396,7.5803881 7.4205563,6.7828173 6.3768897,5.909484 5.333223,5.0361506 4.2895564,4.1628173 3.6921554,3.6088017 4.0313622,2.4386848 4.8517545,2.3264551 5.4192521,2.2207898 5.8521236,2.6886126 6.2299557,3.0353016 7.3573819,4.0259339 8.5168698,4.9826881 9.6180279,6.001615 9.8104659,6.2365064 9.9445657,6.5275948 9.9585564,6.8338173 z"/>
      </g>
    </svg>
    <div class="coords">
      <div>
        <label for="height">Height</label>
        <input type="text" id="height" class="coord">
      </div>
      <div>
        <label for="width">Width</label>
        <input type="text" id="width" class="coord">
      </div>
      <div>
        <label for="select">Select a node</label>
        <input type="text" id="select">
      </div>
    </div>
    <div class="container"></div>
  </body>
</html>
<script src="./bundle.js"></script>
<script>
  (function () {
    var Tree = require('tree')
      , http = require('http')
      , JSONStream = require('JSONStream')
      , container = document.querySelector('.container')
      , tree

    ;[].forEach.call(document.querySelectorAll('.coord'), function (coord) {
      coord.addEventListener('blur', function () {
        container.style[this.id] = this.value  + 'px'
        tree.resize()
      })
    })

    document.querySelector('#select').addEventListener('change', function () {
      tree.select(this.value)
    })

    http.get('/sms-tree.json?depth=4', function (res) {
      tree = new Tree({
        stream: res.pipe(JSONStream.parse([true])),
        accessors: {
          icon: 'nodeType'
        }
      })
      container.appendChild(tree.render().el.node())

      tree.on('selected', function (node) {
        console.log(node)
      })
    })
  })()

</script>
